#!/bin/bash
# bash_profile

declare -a files=(
    "${HOME}/.rvm/scripts/rvm"
    "${HOME}/.dotfiles/bash/bash_config"
    "${HOME}/.dotfiles/bash/bash_aliases"
    "${HOME}/.dotfiles/bash/functions/"*
    "${HOME}/.dotfiles/bash/bash_prompt"
    "${HOME}/.bash_profile.local"
    "${HOME}/.dotfiles/bash/bash_paths"
)

# If these files are readable, source them
for index in ${!files[*]}
do
    if [[ -r ${files[$index]} ]]; then
        source "${files[$index]}"
    fi
done

unset files

# Only use `brew` after it has been added to the PATH
if [[ $(type -P brew) ]]; then
    bash_completion_path="$(brew --prefix)/etc/bash_completion"
fi

# Source Bash completion (installed via Homebrew)
if [[ -r ${bash_completion_path} ]]; then
    source "${bash_completion_path}"
fi

# Add tab completion for SSH hostnames based on ~/.ssh/config, ignoring wildcards
if [[ -e "${HOME}/.ssh/config" ]]; then
    complete -o "default" -o "nospace" -W "$(grep "^Host" ~/.ssh/config | grep -v "[?*]" | cut -d " " -f2 | tr ' ' '\n')" scp sftp ssh
fi

# Add support for grunt autocompletion
if [[ $(type -P grunt) ]]; then
    eval "$(grunt --completion=bash)"
fi
