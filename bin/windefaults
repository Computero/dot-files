#!/bin/bash

# Set custom Windows defaults

#
# General UI/UX
#

# Enable ClearType
reg add "HKCU\Control Panel\Desktop" -v "FontSmoothing" -t REG_SZ -d "2" -f
reg add "HKCU\Control Panel\Desktop" -v "FontSmoothingType" -t REG_DWORD -d "00000002" -f

# Disable hover delay on taskbar previews
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "ExtendedUIHoverTime" -t REG_DWORD -d "00000001" -f

# Disable Aero Peek for desktop
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "DisablePreviewDesktop" -t REG_DWORD -d "00000001" -f

# Determines the interval from the time the cursor is pointed at a menu
# until the menu items are displayed
reg add "HKEY_CURRENT_USER\Control Panel\Desktop" -v "MenuShowDelay" -t REG_SZ -d "0" -f

# Lock the taskbar
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "TaskbarSizeMove" -t REG_DWORD -d "00000000" -f

# Small icons in taskbar
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "TaskbarSmallIcons" -t REG_DWORD -d "00000001" -f

# Don't group items in taskbar
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "TaskbarGlomLevel" -t REG_DWORD -d "00000002" -f

# Disable Flip 3D
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DWM" -v "DisallowFlip3d" -t REG_DWORD -d "00000001" -f

# Disable Aero Shake (hide all other windows when shaking foreground window)
reg add "HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Explorer" -v "NoWindowMinimizingShortcuts" -t REG_DWORD -d "00000001" -f

# Disable automatic update reboot when a user is logged in
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" -v "NoAutoRebootWithLoggedOnUsers" -t REG_DWORD -d "00000001" -f

#
# Explorer
#

# Show hidden files
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Hidden" -t REG_DWORD -d "00000001" -f

# Disable hide file extensions
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "HideFileExt" -t REG_DWORD -d "00000000" -f
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "SuperHidden" -t REG_DWORD -d "00000001" -f

# Hide system protected files
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "ShowSuperHidden" -t REG_DWORD -d "00000000" -f

# Run Explorer windows in separate process
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "SeparateProcess" -t REG_DWORD -d "00000001" -f

# Disable the "Use the Web service to find the correct program" prompt
# for unknown filetypes
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" -v "NoInternetOpenWith" -t REG_DWORD -d "00000001" -f
reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" -v "NoInternetOpenWith" -t REG_DWORD -d "00000001" -f

# Disable Sharing Wizard
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "SharingWizardOn" -t REG_DWORD -d "00000000" -f

#
# Start Menu
#

# Show User as link
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowUser" -t REG_DWORD -d "00000001" -f

# Show Computer as link
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowMyComputer" -t REG_DWORD -d "00000001" -f

# Show Control Panel as link
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowControlPanel" -t REG_DWORD -d "00000001" -f

# Show Network as link
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowNetPlaces" -t REG_DWORD -d "00000001" -f

# Show Downloads as link
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowDownloads" -t REG_DWORD -d "00000001" -f

# Hide Network Connections
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowNetConn" -t REG_DWORD -d "00000000" -f

# Hide Program Access and Defaults
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowSetProgramAccessAndDefaults" -t REG_DWORD -d "00000000" -f

# Hide Documents
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowMyDocs" -t REG_DWORD -d "00000000" -f

# Hide Pictures
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowMyPics" -t REG_DWORD -d "00000000" -f

# Hide Music
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowMyMusic" -t REG_DWORD -d "00000000" -f

# Hide Videos
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowVideos" -t REG_DWORD -d "00000000" -f

# Hide Games
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowMyGames" -t REG_DWORD -d "00000000" -f

# Hide Printers
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowPrinters" -t REG_DWORD -d "00000000" -f

# Hide Help
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -v "Start_ShowHelp" -t REG_DWORD -d "00000000" -f

#
# System
#

# Turn of system beeps
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" -v "NoAutoRebootWithLoggedOnUsers" -t REG_SZ -d "no" -f

# Enable verbose startup/shutdown messages
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -v "VerboseStatus" -t REG_DWORD -d "00000001" -f

# End processes automatically on shutdown
reg add "HKEY_CURRENT_USER\Control Panel\Desktop" -v "AutoEndTasks" -t REG_SZ -d "1" -f

# Specifies how long the system waits for user processes to end after shutdown
reg add "HKEY_CURRENT_USER\Control Panel\Desktop" -v "HungAppTimeout" -t REG_SZ -d "1000" -f

# Determines how long the system waits for user processes to end after
# the user attempts to log off or to shut down
reg add "HKEY_CURRENT_USER\Control Panel\Desktop" -v "WaitToKillAppTimeout" -t REG_SZ -d "2000" -f

# Kill hung services after 5 seconds
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control" -v "WaitToKillServiceTimeout" -t REG_SZ -d "5000" -f

# Disable Low Disk Space checks
reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" -v "NoLowDiskSpaceChecks" -t REG_DWORD -d "00000001" -f
